import 'package:flutter/material.dart';

class TurboOperation extends StatefulWidget {
  @override
  _TurboOperationState createState() => _TurboOperationState();
}

class _TurboOperationState extends State<TurboOperation> {
  List<OperationStep> steps = [
    OperationStep(
      title: 'ANﾃ´ISE DE MERCADO GLOBAL',
      description: 'Kyra analisa tendﾃｪncias em 4 moedas (BRL, USD, EUR, GBP)',
      status: StepStatus.pending,
      platform: 'ChatGPT',
      phase: 'Fase 1',
    ),
    OperationStep(
      title: 'CRIAﾃﾃグ PRODUTO CAMPEﾃグ GLOBAL',
      description: 'Otimizaﾃｧﾃ｣o para vendas acima de \$100 em 4 moedas',
      status: StepStatus.pending,
      platform: 'Kyra AI',
      phase: 'Fase 1',
    ),
    OperationStep(
      title: 'PROFISSIONALIZAﾃﾃグ MULTIMERCADO',
      description: 'Conteﾃｺdo adaptado para BRL, USD, EUR, GBP',
      status: StepStatus.pending,
      platform: 'Stable Diffusion',
      phase: 'Fase 1',
    ),
    OperationStep(
      title: 'LANﾃ②MENTO MULTIPLATAFORMA',
      description: 'Kiwify (BRL/USD) + Hotmart (EUR/GBP)',
      status: StepStatus.pending,
      platform: 'APIs Globais',
      phase: 'Fase 1',
    ),
    OperationStep(
      title: 'CAMPANHA ADS GLOBAL',
      description: 'Meta Ads (BRL/USD) + Google Ads (EUR/GBP)',
      status: StepStatus.pending,
      platform: 'Ads APIs',
      phase: 'Fase 1',
    ),
    OperationStep(
      title: 'OTIMIZAﾃﾃグ MULTIMOEDA',
      description: 'A/B testing em 4 economias simultﾃ｢neas',
      status: StepStatus.pending,
      platform: 'Sistema Kyrium',
      phase: 'Fase 1',
    ),
  ];

  bool isRunning = false;
  int currentStep = 0;

  void _startOperation() async {
    setState(() {
      isRunning = true;
      currentStep = 0;
    });

    for (int i = 0; i < steps.length; i++) {
      await Future.delayed(Duration(seconds: 3));
      
      setState(() {
        steps[i] = steps[i].copyWith(status: StepStatus.completed);
        currentStep = i + 1;
      });
    }

    setState(() {
      isRunning = false;
    });
    
    _showCompletionDialog();
  }

  void _showCompletionDialog() {
    showDialog(
      context: context,
      builder: (context) => AlertDialog(
        backgroundColor: Colors.grey[900],
        title: Text(
          '識 OPERAﾃﾃグ TURBO GLOBAL CONCLUﾃ好A',
          style: TextStyle(color: Colors.amber),
        ),
        content: Text(
          'Chef! Operaﾃｧﾃ｣o Turbo Global executada com sucesso!\n\n'
          '窶｢ 6 etapas automatizadas em 4 moedas\n'
          '窶｢ 4 plataformas globais integradas\n'
          '窶｢ Produtos otimizados para BRL, USD, EUR, GBP\n'
          '窶｢ Reinvestimento automﾃ｡tico cruzado\n'
          '窶｢ Meta R\$18k em andamento + scaling global',
          style: TextStyle(color: Colors.white),
        ),
        actions: [
          TextButton(
            onPressed: () => Navigator.pop(context),
            child: Text('CONTINUAR DOMINANDO', style: TextStyle(color: Colors.amber)),
          ),
        ],
      ),
    );
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      backgroundColor: Colors.black,
      appBar: AppBar(
        backgroundColor: Colors.black,
        title: Text(
          '噫 OPERAﾃﾃグ TURBO GLOBAL',
          style: TextStyle(color: Colors.amber),
        ),
        leading: IconButton(
          icon: Icon(Icons.arrow_back, color: Colors.amber),
          onPressed: () => Navigator.pop(context),
        ),
      ),
      body: Container(
        padding: EdgeInsets.all(20),
        child: Column(
          crossAxisAlignment: CrossAxisAlignment.start,
          children: [
            Container(
              width: double.infinity,
              padding: EdgeInsets.all(15),
              decoration: BoxDecoration(
                gradient: LinearGradient(
                  colors: [Colors.amber, Colors.orange],
                  begin: Alignment.topLeft,
                  end: Alignment.bottomRight,
                ),
                borderRadius: BorderRadius.circular(12),
              ),
              child: Column(
                crossAxisAlignment: CrossAxisAlignment.start,
                children: [
                  Text(
                    'META FASE 1: R\$18.000 EM 30 DIAS - 4 MOEDAS',
                    style: TextStyle(
                      color: Colors.black,
                      fontSize: 16,
                      fontWeight: FontWeight.bold,
                    ),
                  ),
                  SizedBox(height: 5),
                  Text(
                    'Vendas em Real, Dﾃｳlar, Euro e Libra | Produtos acima de \$100',
                    style: TextStyle(
                      color: Colors.black87,
                      fontSize: 12,
                    ),
                  ),
                ],
              ),
            ),
            SizedBox(height: 20),
            
            Text(
              'SEQUﾃ劾CIA AUTOMATIZADA GLOBAL - FASE 1',
              style: TextStyle(
                color: Colors.amber,
                fontSize: 18,
                fontWeight: FontWeight.bold,
              ),
            ),
            SizedBox(height: 10),
            Text(
              'Sistema completo de criaﾃｧﾃ｣o e lanﾃｧamento em 4 economias',
              style: TextStyle(color: Colors.grey),
            ),
            SizedBox(height: 30),
            
            Expanded(
              child: ListView.builder(
                itemCount: steps.length,
                itemBuilder: (context, index) {
                  return _buildStepCard(steps[index], index);
                },
              ),
            ),
            
            SizedBox(
              width: double.infinity,
              height: 60,
              child: ElevatedButton(
                style: ElevatedButton.styleFrom(
                  primary: isRunning ? Colors.grey : Colors.orange,
                  shape: RoundedRectangleBorder(
                    borderRadius: BorderRadius.circular(12),
                  ),
                ),
                onPressed: isRunning ? null : _startOperation,
                child: Text(
                  isRunning ? '売 EXECUTANDO OPERAﾃﾃグ TURBO GLOBAL...' : '噫 INICIAR OPERAﾃﾃグ TURBO GLOBAL',
                  style: TextStyle(
                    fontSize: 16,
                    fontWeight: FontWeight.bold,
                  ),
                ),
              ),
            ),
          ],
        ),
      ),
    );
  }

  Widget _buildStepCard(OperationStep step, int index) {
    return Card(
      color: Colors.grey[900],
      margin: EdgeInsets.only(bottom: 15),
      child: ListTile(
        leading: _getStepIcon(step.status, index),
        title: Text(
          step.title,
          style: TextStyle(
            color: Colors.white,
            fontWeight: FontWeight.bold,
          ),
        ),
        subtitle: Column(
          crossAxisAlignment: CrossAxisAlignment.start,
          children: [
            SizedBox(height: 5),
            Text(
              step.description,
              style: TextStyle(color: Colors.grey),
            ),
            SizedBox(height: 8),
            Row(
              children: [
                Container(
                  padding: EdgeInsets.symmetric(horizontal: 8, vertical: 2),
                  decoration: BoxDecoration(
                    color: step.phase == 'Fase 1' ? Colors.orange : Colors.blue,
                    borderRadius: BorderRadius.circular(8),
                  ),
                  child: Text(
                    step.phase,
                    style: TextStyle(color: Colors.white, fontSize: 10),
                  ),
                ),
                SizedBox(width: 8),
                Container(
                  padding: EdgeInsets.symmetric(horizontal: 8, vertical: 2),
                  decoration: BoxDecoration(
                    color: Colors.amber,
                    borderRadius: BorderRadius.circular(8),
                  ),
                  child: Text(
                    step.platform,
                    style: TextStyle(color: Colors.black, fontSize: 10),
                  ),
                ),
              ],
            ),
          ],
        ),
        trailing: index < currentStep
            ? Icon(Icons.check_circle, color: Colors.green, size: 30)
            : Icon(Icons.schedule, color: Colors.grey, size: 30),
      ),
    );
  }

  Widget _getStepIcon(StepStatus status, int index) {
    if (index < currentStep) {
      return Icon(Icons.check_circle, color: Colors.green, size: 30);
    }
    
    switch (status) {
      case StepStatus.pending:
        return Icon(Icons.radio_button_unchecked, color: Colors.grey, size: 30);
      case StepStatus.running:
        return Icon(Icons.play_arrow, color: Colors.orange, size: 30);
      case StepStatus.completed:
        return Icon(Icons.check_circle, color: Colors.green, size: 30);
      default:
        return Icon(Icons.radio_button_unchecked, color: Colors.grey, size: 30);
    }
  }
}

class OperationStep {
  final String title;
  final String description;
  final StepStatus status;
  final String platform;
  final String phase;

  OperationStep({
    required this.title,
    required this.description,
    required this.status,
    required this.platform,
    required this.phase,
  });

  OperationStep copyWith({
    String? title,
    String? description,
    StepStatus? status,
    String? platform,
    String? phase,
  }) {
    return OperationStep(
      title: title ?? this.title,
      description: description ?? this.description,
      status: status ?? this.status,
      platform: platform ?? this.platform,
      phase: phase ?? this.phase,
    );
  }
}

enum StepStatus { pending, running, completed }
